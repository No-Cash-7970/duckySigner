{"pageProps":{"projectName":"duckySigner","currentAdr":{"slug":"20260210-use-encrypted-duckdb-files-for-data-storage","package":null,"title":"Use Encrypted DuckDB Files for Data Storage","status":"draft","supersededBy":null,"tags":["backend","security"],"deciders":["No-Cash-7970"],"body":{"enhancedMdx":"\n## Context and Problem Statement\n\nThe desktop wallet requires the user's data to be securely stored on the user's device as a file. The file format used to store the user's data needs to support a variety of data types and formats that may change drastically over time.\n\n## Decision Drivers\n\n- **Encryption**: The file format must support encryption of an entire file\n- **Ease of use (in development)**: Ideally, the data in the file should be able to be easily changed (with the right encryption key) while reducing the number of files needed to store all the user's data\n- **Flexibility**: The file format should allow for the structure of the data to change\n\n## Considered Options\n\n- Parquet\n- DuckDB\n\n## Decision Outcome\n\nChose to use encrypted DuckDB files to store the user's data.\n\n### Positive Consequences\n\n- Features, such as Ledger support, can be easily integrated\n- Easier to use more complex data structures to store user data\n\n### Negative Consequences\n\n- More work. A new <AdrLink slug=\"20240217-integrate-kmd-wallet-management-code\" status=\"accepted\" title=\"Integrate KMD Wallet Management Code\" customLabel=\"KMD\" /> driver needs to be created and the dApp connect session storage logic needs to be refactored to replace Parquet files with DuckDB files.\n\n## Pros and Cons of the Options\n\n### Parquet\n\nEncrypted Parquet files were used to store wallet keys and dApp connect session data. Every data table was its own file. DuckDB was used to manage Parquet files.\n\n- Pro: Supports encryption of an entire file\n- Pro: A more common format that is supported by a number for platforms\n- Pro: The wallet currently uses Parquet files. It has been used and well-tested.\n- Con: Massive restructuring of the data is needed for new features, like support for [Ledger devices](https://www.ledger.com/)\n- Con: More files to manage. Each table is a file and they cannot be combined into one file.\n\n### DuckDB\n\nDuckDB has its own file format. Its support for encryption was [recently added in DuckDB v1.4](https://duckdb.org/2025/11/19/encryption-in-duckdb).\n\n- Pro: Supports encryption of an entire file\n- Pro: Like a SQLite file, a single DuckDB file can contain multiple tables, which means fewer files to be managed\n- Con: The DuckDB file format is not a common format and almost exclusive to DuckDB\n\n## Links\n\n- Supersedes <AdrLink slug=\"20250716-use-duckdb-and-parquet-files-for-data-storage\" status=\"superseded\" title=\"Use DuckDB &amp; Parquet Files for Data Storage\" />\n- [Data-at-Rest Encryption in DuckDB - DuckDB Blog](https://duckdb.org/2025/11/19/encryption-in-duckdb)\n- [Reading and Writing Parquet Files - DuckDB Docs](https://duckdb.org/docs/stable/data/parquet/overview)\n"},"creationDate":"2026-02-11T03:58:38.000Z","lastEditDate":"2026-02-11T03:58:38.000Z","lastEditAuthor":"No-Cash-7970","publicationDate":"2026-02-11T07:59:59.000Z","file":{"relativePath":"docs/decisions/20260210-use-encrypted-duckdb-files-for-data-storage.md","absolutePath":"/home/runner/work/duckySigner/duckySigner/docs/decisions/20260210-use-encrypted-duckdb-files-for-data-storage.md"},"repository":{"provider":"github","viewUrl":"https://github.com/No-Cash-7970/duckySigner/blob/master/docs/decisions/20260210-use-encrypted-duckdb-files-for-data-storage.md"}},"l4bVersion":"1.1.0"},"__N_SSG":true}